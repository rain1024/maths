<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i To√°n V√≤ng Tr√≤n - Minh H·ªça T∆∞∆°ng T√°c</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #1a1a1a;
            color: #e0e0e0;
            height: 100vh;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: #262626;
            border-bottom: 1px solid #3d3d3d;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header h1 {
            color: #ffa116;
            font-size: 1.5em;
            font-weight: 600;
        }

        .header-btn {
            background: #ffa116;
            color: #1a1a1a;
            border: none;
            padding: 8px 20px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .header-btn:hover {
            background: #ff8800;
            transform: translateY(-1px);
        }

        /* Main Container */
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
        }

        /* Left Panel */
        .left-panel {
            width: 45%;
            background: #262626;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #3d3d3d;
        }

        /* Step Tabs */
        .step-tabs {
            display: flex;
            background: #1a1a1a;
            border-bottom: 1px solid #3d3d3d;
        }

        .step-tab {
            flex: 1;
            padding: 14px 16px;
            background: transparent;
            border: none;
            color: #a0a0a0;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .step-tab:hover {
            background: #2d2d2d;
            color: #e0e0e0;
        }

        .step-tab.active {
            color: #ffa116;
            border-bottom-color: #ffa116;
            background: #262626;
        }

        /* Step Content */
        .step-content-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Section */
        .section {
            background: #1a1a1a;
            border: 1px solid #3d3d3d;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .section h3 {
            color: #ffa116;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .section p {
            line-height: 1.8;
            color: #e0e0e0;
            margin-bottom: 10px;
        }

        .section ul {
            list-style: none;
            padding-left: 0;
        }

        .section ul li {
            padding: 6px 0 6px 20px;
            position: relative;
            color: #c0c0c0;
            line-height: 1.6;
        }

        .section ul li:before {
            content: "‚ñ∏";
            position: absolute;
            left: 0;
            color: #ffa116;
        }

        .highlight-box {
            background: #2d2d00;
            border-left: 4px solid #ffa116;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        /* Input */
        .input-group {
            margin: 15px 0;
        }

        .input-group label {
            display: block;
            color: #e0e0e0;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .input-group input {
            width: 100%;
            padding: 10px;
            background: #1a1a1a;
            border: 1px solid #3d3d3d;
            border-radius: 6px;
            color: #e0e0e0;
            font-size: 14px;
        }

        .input-group input:focus {
            outline: none;
            border-color: #ffa116;
        }

        /* Right Panel */
        .right-panel {
            width: 55%;
            background: #1a1a1a;
            display: flex;
            flex-direction: column;
        }

        .solution-header {
            background: #262626;
            padding: 16px 24px;
            border-bottom: 1px solid #3d3d3d;
        }

        .solution-header h2 {
            color: #ffa116;
            font-size: 1.2em;
        }

        .solution-content {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        /* Answer Box */
        .answer-box {
            background: linear-gradient(135deg, #ffa116 0%, #ff8800 100%);
            color: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 20px;
        }

        /* Explanation */
        .explanation {
            background: #262626;
            border: 1px solid #3d3d3d;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .explanation h3 {
            color: #ffa116;
            margin-bottom: 15px;
        }

        .formula {
            background: #1a1a1a;
            border: 1px solid #3d3d3d;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        /* Visualization */
        .visualization-container {
            background: #262626;
            border: 1px solid #3d3d3d;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .visualization-container h3 {
            color: #ffa116;
            margin-bottom: 20px;
            text-align: center;
        }

        .circle-container {
            width: 100%;
            max-width: 450px;
            height: 450px;
            margin: 0 auto;
            position: relative;
        }

        .person {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #3d8cf7;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s;
        }

        .person.highlight {
            background: #ffa116;
            transform: scale(1.5);
            z-index: 10;
            box-shadow: 0 0 20px rgba(255, 161, 22, 0.6);
        }

        .number-list {
            background: #262626;
            border: 1px solid #3d3d3d;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .number-list h4 {
            color: #ffa116;
            margin-bottom: 15px;
        }

        .numbers {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .number-item {
            background: #3d8cf7;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: 600;
            min-width: 50px;
            text-align: center;
        }

        .number-item.target {
            background: #ffa116;
            transform: scale(1.1);
        }

        .legend {
            text-align: center;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 6px;
            margin-top: 15px;
        }

        .legend span {
            margin: 0 15px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #c0c0c0;
            font-size: 14px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: inline-block;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        ::-webkit-scrollbar-thumb {
            background: #3d3d3d;
            border-radius: 5px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
            }
            .left-panel, .right-panel {
                width: 100%;
                height: 50vh;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>üéØ B√†i To√°n V√≤ng Tr√≤n</h1>
        <button class="header-btn" onclick="calculate()">‚ö° Gi·∫£i Ngay</button>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Panel: Problem & Steps -->
        <div class="left-panel">
            <div class="step-tabs">
                <button class="step-tab active" onclick="showStep(0)">ƒê·ªÅ b√†i</button>
                <button class="step-tab" onclick="showStep(1)">1. T√¨m hi·ªÉu</button>
                <button class="step-tab" onclick="showStep(2)">2. T√¨m t√≤i</button>
                <button class="step-tab" onclick="showStep(3)">3. Ph∆∞∆°ng ph√°p</button>
                <button class="step-tab" onclick="showStep(4)">4. M·ªü r·ªông</button>
            </div>

            <div class="step-content-container">
                <!-- Step 0: ƒê·ªÅ b√†i -->
                <div id="step0" class="step-content active">
                    <div class="section">
                        <h3>üìã ƒê·ªÅ B√†i: B√†i To√°n V√≤ng Tr√≤n</h3>
                        <p id="problem-text-simple">
                            C√≥ <strong>20</strong> ng∆∞·ªùi ƒë·ª©ng th√†nh v√≤ng tr√≤n, t·∫•t c·∫£ ƒë·ªÅu quay m·∫∑t v√†o t√¢m, c√°c v·ªã tr√≠ ƒë·ª©ng ƒë∆∞·ª£c ƒë√°nh s·ªë th·ª© t·ª± t·ª´ 1 ƒë·∫øn <strong>20</strong> theo chi·ªÅu kim ƒë·ªìng h·ªì. H·ªç ƒë·ªçc c√°c s·ªë t·ª± nhi√™n t·ª´ 1, 2, 3, ... theo chi·ªÅu kim ƒë·ªìng h·ªì nh∆∞ sau:
                        </p>
                        <ul style="margin-top: 15px;">
                            <li>Ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ th·ª© nh·∫•t ƒë·ªçc s·ªë 1</li>
                            <li>Ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ th·ª© hai ƒë·ªçc s·ªë 2</li>
                            <li>Ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ th·ª© ba ƒë·ªçc s·ªë 3</li>
                            <li>V√† c·ª© th·∫ø ti·∫øp t·ª•c...</li>
                        </ul>
                        <p style="margin-top: 15px;">
                            Ng∆∞·ªùi k·∫ø ti·∫øp ƒë·ªçc s·ªë t·ª± nhi√™n l·ªõn h∆°n 1 ƒë∆°n v·ªã so v·ªõi s·ªë m√¨nh v·ª´a nghe c·ªßa ng∆∞·ªùi b√™n c·∫°nh ƒë·ªçc.
                        </p>
                        <p style="margin-top: 20px; padding: 15px; background: #2d2d2d; border-radius: 8px; border-left: 4px solid #666;">
                            <strong>C√¢u h·ªèi: Ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ bao nhi√™u s·∫Ω ƒë·ªçc s·ªë <span id="target-display-simple">2012</span>?</strong>
                        </p>
                    </div>

                    <div class="section">
                        <h3>üéØ Tham S·ªë ƒê·∫ßu V√†o</h3>
                        <div class="input-group">
                            <label>S·ªë ng∆∞·ªùi trong v√≤ng tr√≤n (n):</label>
                            <input type="number" id="numPeople" value="20" min="2" max="100" onchange="updateProblemStatement()">
                        </div>
                        <div class="input-group">
                            <label>S·ªë c·∫ßn t√¨m v·ªã tr√≠ (target):</label>
                            <input type="number" id="target" value="2012" min="1" onchange="updateProblemStatement()">
                        </div>
                    </div>
                </div>

                <!-- Step 1: T√¨m hi·ªÉu -->
                <div id="step1" class="step-content">
                    <div class="section">
                        <h3>üìã ƒê·ªÅ B√†i</h3>
                        <p id="problem-text">
                            C√≥ <strong style="color: #ffa116;">20</strong> ng∆∞·ªùi ƒë·ª©ng th√†nh v√≤ng tr√≤n, t·∫•t c·∫£ ƒë·ªÅu quay m·∫∑t v√†o t√¢m, c√°c v·ªã tr√≠ ƒë·ª©ng ƒë∆∞·ª£c ƒë√°nh s·ªë th·ª© t·ª± t·ª´ 1 ƒë·∫øn <strong style="color: #ffa116;">20</strong> theo chi·ªÅu kim ƒë·ªìng h·ªì. H·ªç ƒë·ªçc c√°c s·ªë t·ª± nhi√™n t·ª´ 1, 2, 3, ... theo chi·ªÅu kim ƒë·ªìng h·ªì.
                        </p>
                        <ul style="margin-top: 15px;">
                            <li>Ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ th·ª© nh·∫•t ƒë·ªçc s·ªë 1</li>
                            <li>Ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ th·ª© hai ƒë·ªçc s·ªë 2</li>
                            <li>Ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ th·ª© ba ƒë·ªçc s·ªë 3</li>
                            <li>V√† c·ª© th·∫ø ti·∫øp t·ª•c...</li>
                        </ul>
                        <div class="highlight-box" style="margin-top: 20px;">
                            <strong>‚ùì C√¢u h·ªèi: Ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ bao nhi√™u s·∫Ω ƒë·ªçc s·ªë <span id="target-display" style="color: #ffa116; font-size: 1.2em;">2012</span>?</strong>
                        </div>
                    </div>

                    <div class="section">
                        <h3>üìå C√°c Y·∫øu T·ªë Quan Tr·ªçng</h3>
                        <ul>
                            <li><strong>S·ªë ng∆∞·ªùi:</strong> <span id="num-people-display">20</span> ng∆∞·ªùi</li>
                            <li><strong>V·ªã tr√≠ ƒë·ª©ng:</strong> ƒê√°nh s·ªë t·ª´ 1 ƒë·∫øn <span id="num-people-display2">20</span></li>
                            <li><strong>C√°ch ƒë·ªçc s·ªë:</strong> Theo chi·ªÅu kim ƒë·ªìng h·ªì, li√™n ti·∫øp</li>
                            <li><strong>S·ªë c·∫ßn t√¨m v·ªã tr√≠:</strong> <span id="target-display2">2012</span></li>
                        </ul>
                    </div>
                </div>

                <!-- Step 2 -->
                <div id="step2" class="step-content">
                    <div class="section">
                        <h3>üìä Ph√¢n T√≠ch D·ªØ Ki·ªán</h3>
                        <ul>
                            <li><strong>D·ªØ ki·ªán cho:</strong> S·ªë ng∆∞·ªùi (n), s·ªë c·∫ßn t√¨m (target)</li>
                            <li><strong>C·∫ßn t√¨m:</strong> V·ªã tr√≠ c·ªßa ng∆∞·ªùi ƒë·ªçc s·ªë target</li>
                            <li><strong>M·ªëi li√™n h·ªá:</strong> Sau m·ªói v√≤ng, m·ªói ng∆∞·ªùi ƒë·ªçc th√™m 1 s·ªë m·ªõi</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>üîç Nh·∫≠n X√©t Quan Tr·ªçng</h3>
                        <ul>
                            <li>Ng∆∞·ªùi ·ªü v·ªã tr√≠ 1 ƒë·ªçc: 1, 21, 41, 61, ... (c√¥ng sai = 20)</li>
                            <li>Ng∆∞·ªùi ·ªü v·ªã tr√≠ 2 ƒë·ªçc: 2, 22, 42, 62, ... (c√¥ng sai = 20)</li>
                            <li>Ng∆∞·ªùi ·ªü v·ªã tr√≠ k ƒë·ªçc: k, k+n, k+2n, k+3n, ...</li>
                            <li>V·∫•n ƒë·ªÅ: T√¨m k sao cho s·ªë target c√≥ d·∫°ng k + m√ón</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>üéØ K·∫ø Ho·∫°ch Gi·∫£i</h3>
                        <ul>
                            <li><strong>Ph∆∞∆°ng ph√°p:</strong> S·ª≠ d·ª•ng ph√©p chia c√≥ d∆∞ (modulo)</li>
                            <li><strong>C√¥ng th·ª©c d·ª± ki·∫øn:</strong> V·ªã tr√≠ = target mod n</li>
                            <li><strong>Tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát:</strong> N·∫øu target chia h·∫øt cho n ‚Üí v·ªã tr√≠ = n</li>
                            <li><strong>Ki·ªÉm ch·ª©ng:</strong> Th·ª≠ v·ªõi v√≠ d·ª• nh·ªè tr∆∞·ªõc</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>üìù V√≠ D·ª• Minh H·ªça</h3>
                        <p style="background: #2d2d2d; padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <strong>V√≠ d·ª•:</strong> n = 5, target = 13<br><br>
                            ‚Ä¢ 13 √∑ 5 = 2 d∆∞ 3<br>
                            ‚Ä¢ V·∫≠y ng∆∞·ªùi ·ªü v·ªã tr√≠ 3 ƒë·ªçc s·ªë 13<br>
                            ‚Ä¢ Ki·ªÉm tra: V·ªã tr√≠ 3 ƒë·ªçc: 3, 8, <strong style="color: #ffa116;">13</strong>, 18, ... ‚úì
                        </p>
                    </div>
                </div>

                <!-- Step 3 -->
                <div id="step3" class="step-content">
                    <div class="section">
                        <h3>üìê C√¥ng Th·ª©c To√°n H·ªçc</h3>
                        <div class="formula">
                            $$P = \begin{cases}
                            \text{target} \bmod n & \text{if } \text{target} \bmod n \neq 0 \\
                            n & \text{if } \text{target} \bmod n = 0
                            \end{cases}$$
                            <p style="margin-top: 10px; font-size: 14px; color: #a0a0a0;">
                                Trong ƒë√≥: \(P\) = v·ªã tr√≠ c·∫ßn t√¨m, \(n\) = s·ªë ng∆∞·ªùi trong v√≤ng tr√≤n
                            </p>
                        </div>
                    </div>

                    <div class="section">
                        <h3>üí° Gi·∫£i Th√≠ch</h3>
                        <ul>
                            <li>Ph√©p chia c√≥ d∆∞ cho bi·∫øt v·ªã tr√≠ trong chu k·ª≥</li>
                            <li>N·∫øu chia h·∫øt (d∆∞ 0) ‚Üí v·ªã tr√≠ cu·ªëi c√πng trong v√≤ng</li>
                            <li>N·∫øu c√≤n d∆∞ ‚Üí d∆∞ ch√≠nh l√† v·ªã tr√≠ c·∫ßn t√¨m</li>
                            <li>ƒê·ªô ph·ª©c t·∫°p: O(1) - r·∫•t hi·ªáu qu·∫£!</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>üî¢ V√≠ D·ª• √Åp D·ª•ng</h3>
                        <p style="background: #2d2d2d; padding: 15px; border-radius: 8px;">
                            <strong>V·ªõi n = 20, target = 2012:</strong><br><br>
                            ‚Ä¢ 2012 √∑ 20 = 100 d∆∞ 12<br>
                            ‚Ä¢ V·∫≠y v·ªã tr√≠ = <strong style="color: #ffa116;">12</strong><br>
                            ‚Ä¢ Ki·ªÉm ch·ª©ng: 12 + 100√ó20 = 2012 ‚úì
                        </p>
                    </div>
                </div>

                <!-- Step 4 -->
                <div id="step4" class="step-content">
                    <div class="section">
                        <h3>üéì C√¥ng Th·ª©c T·ªïng Qu√°t</h3>
                        <div class="formula">
                            $$P(n, k) = \begin{cases}
                            k \bmod n & \text{if } k \bmod n \neq 0 \\
                            n & \text{if } k \bmod n = 0
                            \end{cases}$$
                        </div>
                    </div>

                    <div class="section">
                        <h3>üîÑ C√°c Bi·∫øn Th·ªÉ Th√∫ V·ªã</h3>
                        <ul>
                            <li><strong>Bi·∫øn th·ªÉ 1:</strong> N·∫øu ƒë·ªçc ng∆∞·ª£c chi·ªÅu kim ƒë·ªìng h·ªì th√¨ sao?</li>
                            <li><strong>Bi·∫øn th·ªÉ 2:</strong> N·∫øu m·ªói l·∫ßn ƒë·∫øm c√°ch 1 ng∆∞·ªùi (1, 3, 5, ...) th√¨ sao?</li>
                            <li><strong>Bi·∫øn th·ªÉ 3:</strong> T√¨m t·∫•t c·∫£ v·ªã tr√≠ ƒë·ªçc s·ªë d·∫°ng \(100k + 12\)</li>
                            <li><strong>Bi·∫øn th·ªÉ 4:</strong> N·∫øu b·∫Øt ƒë·∫ßu ƒë·∫øm t·ª´ s·ªë 0 thay v√¨ 1?</li>
                        </ul>
                    </div>

                    <div class="section">
                        <h3>üí° ·ª®ng D·ª•ng Th·ª±c T·∫ø</h3>
                        <ul>
                            <li><strong>L·∫≠p l·ªãch:</strong> X√°c ƒë·ªãnh th·ª© trong tu·∫ßn c·ªßa ng√†y b·∫•t k·ª≥</li>
                            <li><strong>M·∫≠t m√£:</strong> Caesar cipher v√† c√°c bi·∫øn th·ªÉ</li>
                            <li><strong>Tr√≤ ch∆°i:</strong> Josephus problem (lo·∫°i b·ªè ng∆∞·ªùi)</li>
                            <li><strong>Khoa h·ªçc m√°y t√≠nh:</strong> Hash table circular addressing</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel: Solution & Visualization -->
        <div class="right-panel">
            <div class="solution-header">
                <h2>üí° L·ªùi Gi·∫£i & Minh H·ªça</h2>
            </div>

            <div class="solution-content">
                <div id="solution-container" style="display:none;">
                    <div class="answer-box">
                        <div id="answer"></div>
                    </div>

                    <div class="explanation">
                        <h3>üìê L·ªùi Gi·∫£i Chi Ti·∫øt</h3>
                        <div id="explanation-content"></div>
                    </div>
                </div>

                <div id="initial-message" style="text-align: center; padding: 40px 20px; color: #666;">
                    <div style="font-size: 4em; margin-bottom: 20px;">üéØ</div>
                    <h3 style="color: #ffa116; margin-bottom: 15px;">S·∫µn s√†ng ƒë·ªÉ gi·∫£i b√†i to√°n?</h3>
                    <p style="margin-bottom: 20px;">Nh·∫•n n√∫t "Gi·∫£i Ngay" ·ªü tr√™n ƒë·ªÉ xem l·ªùi gi·∫£i v√† minh h·ªça tr·ª±c quan</p>
                </div>

                <div id="visualization-section" style="display:none;">
                    <div class="visualization-container">
                        <h3>üé® Minh H·ªça V√≤ng Tr√≤n</h3>
                        <div class="circle-container" id="circle"></div>
                        <div class="legend">
                            <span>
                                <span class="legend-color" style="background: #3d8cf7;"></span>
                                V·ªã tr√≠ th∆∞·ªùng
                            </span>
                            <span>
                                <span class="legend-color" style="background: #ffa116;"></span>
                                V·ªã tr√≠ k·∫øt qu·∫£
                            </span>
                        </div>
                    </div>

                    <div class="number-list">
                        <h4>üìä C√°c S·ªë ƒê√£ ƒê·ªçc B·ªüi V·ªã Tr√≠ <span id="position-display"></span></h4>
                        <div class="numbers" id="numbers-list"></div>
                        <p style="margin-top: 15px; color: #999; text-align: center;">
                            T·ªïng c·ªông: <strong id="count-display" style="color: #ffa116;"></strong> s·ªë
                            <br><em>(Hi·ªÉn th·ªã t·ªëi ƒëa 20 s·ªë ƒë·∫ßu ti√™n)</em>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let calculationDone = false;

        function showStep(stepNumber) {
            // Update tabs
            const tabs = document.querySelectorAll('.step-tab');
            const contents = document.querySelectorAll('.step-content');

            tabs.forEach((tab, index) => {
                tab.classList.toggle('active', index === stepNumber);
            });

            contents.forEach((content, index) => {
                content.classList.toggle('active', index === stepNumber);
            });
        }

        function updateProblemStatement() {
            const numPeople = parseInt(document.getElementById('numPeople').value);
            const target = parseInt(document.getElementById('target').value);

            if (numPeople >= 2 && target >= 1) {
                // Update simple problem text (Step 0)
                document.getElementById('problem-text-simple').innerHTML =
                    `C√≥ <strong>${numPeople}</strong> ng∆∞·ªùi ƒë·ª©ng th√†nh v√≤ng tr√≤n, t·∫•t c·∫£ ƒë·ªÅu quay m·∫∑t v√†o t√¢m, c√°c v·ªã tr√≠ ƒë·ª©ng ƒë∆∞·ª£c ƒë√°nh s·ªë th·ª© t·ª± t·ª´ 1 ƒë·∫øn <strong>${numPeople}</strong> theo chi·ªÅu kim ƒë·ªìng h·ªì. H·ªç ƒë·ªçc c√°c s·ªë t·ª± nhi√™n t·ª´ 1, 2, 3, ... theo chi·ªÅu kim ƒë·ªìng h·ªì nh∆∞ sau:`;

                // Update highlighted problem text (Step 1)
                document.getElementById('problem-text').innerHTML =
                    `C√≥ <strong style="color: #ffa116;">${numPeople}</strong> ng∆∞·ªùi ƒë·ª©ng th√†nh v√≤ng tr√≤n, t·∫•t c·∫£ ƒë·ªÅu quay m·∫∑t v√†o t√¢m, c√°c v·ªã tr√≠ ƒë·ª©ng ƒë∆∞·ª£c ƒë√°nh s·ªë th·ª© t·ª± t·ª´ 1 ƒë·∫øn <strong style="color: #ffa116;">${numPeople}</strong> theo chi·ªÅu kim ƒë·ªìng h·ªì. H·ªç ƒë·ªçc c√°c s·ªë t·ª± nhi√™n t·ª´ 1, 2, 3, ... theo chi·ªÅu kim ƒë·ªìng h·ªì.`;

                document.getElementById('target-display-simple').textContent = target;
                document.getElementById('target-display').textContent = target;
                document.getElementById('target-display2').textContent = target;
                document.getElementById('num-people-display').textContent = numPeople;
                document.getElementById('num-people-display2').textContent = numPeople;

                calculationDone = false;
                document.getElementById('solution-container').style.display = 'none';
                document.getElementById('visualization-section').style.display = 'none';
                document.getElementById('initial-message').style.display = 'block';
            }
        }

        function findPosition(numPeople, target) {
            const position = target % numPeople;
            return position === 0 ? numPeople : position;
        }

        function countRounds(numPeople, target) {
            return Math.floor((target - 1) / numPeople);
        }

        function getNumbersReadByPosition(numPeople, position, maxNumber) {
            const numbers = [];
            let current = position;

            while (current <= maxNumber) {
                numbers.push(current);
                current += numPeople;
            }

            return numbers;
        }

        function drawCircle(numPeople, highlightPosition) {
            const container = document.getElementById('circle');
            container.innerHTML = '';

            const radius = 180;
            const centerX = 225;
            const centerY = 225;

            for (let i = 1; i <= numPeople; i++) {
                const angle = (i - 1) * (2 * Math.PI / numPeople) - Math.PI / 2;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);

                const person = document.createElement('div');
                person.className = 'person';
                if (i === highlightPosition) {
                    person.className += ' highlight';
                }
                person.textContent = i;
                person.style.left = (x - 20) + 'px';
                person.style.top = (y - 20) + 'px';

                container.appendChild(person);
            }
        }

        function calculate() {
            const numPeople = parseInt(document.getElementById('numPeople').value);
            const target = parseInt(document.getElementById('target').value);

            if (numPeople < 2) {
                alert('S·ªë ng∆∞·ªùi ph·∫£i √≠t nh·∫•t l√† 2!');
                return;
            }

            if (target < 1) {
                alert('S·ªë c·∫ßn t√¨m ph·∫£i l·ªõn h∆°n 0!');
                return;
            }

            // Calculate
            const position = findPosition(numPeople, target);
            const rounds = countRounds(numPeople, target);
            const numbersRead = getNumbersReadByPosition(numPeople, position, target);

            // Show solution
            document.getElementById('initial-message').style.display = 'none';
            document.getElementById('solution-container').style.display = 'block';
            document.getElementById('visualization-section').style.display = 'block';

            document.getElementById('answer').innerHTML =
                `ƒê√°p √°n: V·ªã tr√≠ <span style="font-size: 1.5em;">${position}</span>`;

            // Explanation - Chi ti·∫øt cho h·ªçc sinh l·ªõp 4
            let explanation = `
                <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h4 style="color: #ffa116; margin-bottom: 10px;">ü§î C√°ch Suy Nghƒ©</h4>
                    <p style="line-height: 1.8; color: #e0e0e0;">
                        H√£y t∆∞·ªüng t∆∞·ª£ng: C√≥ ${numPeople} b·∫°n ƒë·ª©ng th√†nh v√≤ng tr√≤n. C√°c b·∫°n l·∫ßn l∆∞·ª£t ƒë·ªçc s·ªë t·ª´ 1, 2, 3, 4, ...
                        Khi ƒë·∫øn b·∫°n cu·ªëi c√πng (v·ªã tr√≠ ${numPeople}), b·∫°n ti·∫øp theo (v·ªã tr√≠ 1) s·∫Ω ƒë·ªçc ti·∫øp.
                    </p>
                    <p style="line-height: 1.8; color: #e0e0e0; margin-top: 10px;">
                        <strong style="color: #ffa116;">ƒêi·ªÉm quan tr·ªçng:</strong> C·ª© m·ªói ${numPeople} s·ªë, l·∫°i quay l·∫°i v·ªã tr√≠ ƒë·∫ßu ti√™n!
                    </p>
                </div>

                <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h4 style="color: #ffa116; margin-bottom: 10px;">üìù B∆∞·ªõc 1: T√¨m Quy Lu·∫≠t Chung</h4>
                    <p style="line-height: 1.8; color: #e0e0e0;">
                        H√£y xem c√°c b·∫°n ·ªü c√°c v·ªã tr√≠ kh√°c nhau s·∫Ω ƒë·ªçc nh·ªØng s·ªë n√†o:
                    </p>
                    <div style="background: #2d2d2d; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <ul style="list-style: none; padding-left: 0;">
                            <li style="padding: 5px 0; color: #c0c0c0;">‚ñ∏ <strong style="color: #ffa116;">V·ªã tr√≠ 1:</strong> ƒê·ªçc c√°c s·ªë 1, ${1 + numPeople}, ${1 + 2*numPeople}, ${1 + 3*numPeople}, ...</li>
                            <li style="padding: 5px 0; color: #c0c0c0;">‚ñ∏ <strong style="color: #ffa116;">V·ªã tr√≠ 2:</strong> ƒê·ªçc c√°c s·ªë 2, ${2 + numPeople}, ${2 + 2*numPeople}, ${2 + 3*numPeople}, ...</li>
                            <li style="padding: 5px 0; color: #c0c0c0;">‚ñ∏ <strong style="color: #ffa116;">V·ªã tr√≠ 3:</strong> ƒê·ªçc c√°c s·ªë 3, ${3 + numPeople}, ${3 + 2*numPeople}, ${3 + 3*numPeople}, ...</li>
                            <li style="padding: 5px 0; color: #c0c0c0;">‚ñ∏ ...</li>
                        </ul>
                    </div>
                    <p style="line-height: 1.8; color: #e0e0e0; margin-top: 10px;">
                        <strong>Quy lu·∫≠t:</strong> Ng∆∞·ªùi ·ªü v·ªã tr√≠ n√†o ƒë√≥ s·∫Ω ƒë·ªçc c√°c s·ªë c√°ch nhau ${numPeople} ƒë∆°n v·ªã!
                    </p>
                    <p style="line-height: 1.8; color: #e0e0e0; margin-top: 5px;">
                        V√≠ d·ª•: Ng∆∞·ªùi v·ªã tr√≠ <strong style="color: #ffa116;">k</strong> ƒë·ªçc: k, k+${numPeople}, k+${2*numPeople}, k+${3*numPeople}, ...
                    </p>
                </div>

                <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h4 style="color: #ffa116; margin-bottom: 10px;">üî¢ B∆∞·ªõc 2: Chia ƒê·ªÉ T√¨m V·ªã Tr√≠</h4>
                    <p style="line-height: 1.8; color: #e0e0e0;">
                        ƒê·ªÉ t√¨m ai ƒë·ªçc s·ªë ${target}, ta l√†m ph√©p chia:
                    </p>
                    <div style="background: #2d2d2d; padding: 15px; border-radius: 8px; margin: 10px 0; text-align: center;">
                        <p style="font-size: 1.2em; color: #ffa116; margin-bottom: 10px;">
                            ${target} √∑ ${numPeople} = <strong>${Math.floor(target / numPeople)}</strong> d∆∞ <strong>${target % numPeople === 0 ? numPeople : target % numPeople}</strong>
                        </p>
                    </div>
                    <ul style="list-style: none; padding-left: 0; margin-top: 10px;">
                        <li style="padding: 5px 0; color: #c0c0c0;">‚ñ∏ <strong>Th∆∞∆°ng ${Math.floor(target / numPeople)}:</strong> Nghƒ©a l√† v√≤ng tr√≤n ƒë√£ quay ƒë∆∞·ª£c ${Math.floor(target / numPeople)} v√≤ng ƒë·∫ßy ƒë·ªß</li>
                        <li style="padding: 5px 0; color: #c0c0c0;">‚ñ∏ <strong>D∆∞ ${target % numPeople === 0 ? numPeople : target % numPeople}:</strong> ƒê√¢y ch√≠nh l√† v·ªã tr√≠ c·ªßa ng∆∞·ªùi ƒë·ªçc s·ªë ${target}!</li>
                    </ul>
                </div>

                <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h4 style="color: #ffa116; margin-bottom: 10px;">‚úÖ B∆∞·ªõc 3: Ki·ªÉm Tra L·∫°i</h4>
                    <p style="line-height: 1.8; color: #e0e0e0;">
                        H√£y ki·ªÉm tra xem ƒë√°p √°n c√≥ ƒë√∫ng kh√¥ng:
                    </p>
                    <div style="background: #2d2d2d; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <p style="color: #c0c0c0; line-height: 1.8;">
                            Ng∆∞·ªùi ·ªü v·ªã tr√≠ <strong style="color: #ffa116;">${position}</strong> ƒë·ªçc s·ªë th·ª© <strong>${numbersRead.length}</strong>
                        </p>
                        <p style="color: #c0c0c0; line-height: 1.8; margin-top: 5px;">
                            T√≠nh: ${position} + ${rounds} √ó ${numPeople} = ${position} + ${rounds * numPeople} = <strong style="color: #ffa116;">${target}</strong> ‚úì
                        </p>
                    </div>
                </div>

                <div style="background: #2d2d00; border-left: 4px solid #ffa116; padding: 15px; border-radius: 8px;">
                    <h4 style="color: #ffa116; margin-bottom: 10px;">üí° K·∫øt Lu·∫≠n</h4>
                    <p style="line-height: 1.8; color: #e0e0e0;">
                        <strong>V·∫≠y ng∆∞·ªùi ƒë·ª©ng ·ªü v·ªã tr√≠ ${position} s·∫Ω ƒë·ªçc s·ªë ${target}.</strong>
                    </p>
                    <p style="line-height: 1.8; color: #c0c0c0; margin-top: 10px; font-size: 0.95em;">
                        <strong>M·∫πo nh·ªè:</strong> Mu·ªën bi·∫øt ai ƒë·ªçc m·ªôt s·ªë b·∫•t k·ª≥, ch·ªâ c·∫ßn l·∫•y s·ªë ƒë√≥ chia cho s·ªë ng∆∞·ªùi trong v√≤ng tr√≤n,
                        s·ªë d∆∞ ch√≠nh l√† v·ªã tr√≠ c·∫ßn t√¨m! (N·∫øu chia h·∫øt th√¨ l√† v·ªã tr√≠ cu·ªëi c√πng)
                    </p>
                </div>
            `;
            document.getElementById('explanation-content').innerHTML = explanation;

            // Render MathJax
            if (window.MathJax) {
                MathJax.typesetPromise([document.getElementById('explanation-content')]).catch((err) => console.log(err));
            }

            // Draw circle
            drawCircle(numPeople, position);

            // Display numbers
            document.getElementById('position-display').textContent = position;
            const numbersList = document.getElementById('numbers-list');
            numbersList.innerHTML = '';

            const displayLimit = 20;
            const numbersToDisplay = numbersRead.slice(0, displayLimit);

            numbersToDisplay.forEach((num) => {
                const item = document.createElement('div');
                item.className = 'number-item';
                if (num === target) {
                    item.className += ' target';
                }
                item.textContent = num;
                numbersList.appendChild(item);
            });

            if (numbersRead.length > displayLimit) {
                const more = document.createElement('div');
                more.className = 'number-item';
                more.style.background = '#3d3d3d';
                more.textContent = `... (+${numbersRead.length - displayLimit})`;
                numbersList.appendChild(more);
            }

            document.getElementById('count-display').textContent = numbersRead.length;

            calculationDone = true;
        }

        // Initialize
        window.onload = function() {
            updateProblemStatement();
        };
    </script>
</body>
</html>
